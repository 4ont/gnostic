// GENERATED FILE: DO NOT EDIT!

package {{.Model.Package}}

import (
  "bytes"
  "encoding/json"
  "fmt"
  "io/ioutil"
  "net/http"
  "net/url"
  "strings"
)
  
// API client representation.
type Client struct {
	service string
	APIKey string
} 

// Create an API client.
func NewClient(service string) *Client {
	client := &Client{}
	client.service = service
	return client
}

//-{{range .Model.Methods}}
{{commentForText .Description}}
//-{{if eq .ResultTypeName ""}}
func (client *Client) {{.ClientName}}({{parameterList .}}) (err error) {
//-{{else}}
func (client *Client) {{.ClientName}}({{parameterList .}}) (response *{{.ResultTypeName}}, err error) {
//-{{end}}
	path := client.service + "{{.Path}}"
	//-{{if hasPathParameters .}}
	//-{{range .ParametersType.Fields}}	
	//-{{if eq .Position "path"}}
	path = strings.Replace(path, "{" + "{{.Name}}" + "}", fmt.Sprintf("%v", {{.ParameterName}}), 1)
	//-{{end}}
   	//-{{end}}
    //-{{end}}
   	//-{{if hasQueryParameters .}}
   	v := url.Values{}
	//-{{range .ParametersType.Fields}}	
	//-{{if eq .Position "query"}}
    v.Set("{{.Name}}", {{.ParameterName}})
	//-{{end}}
	//-{{end}}
    v.Set("key", client.APIKey)
    path = path + "?" + v.Encode()
	//-{{end}}
	//-{{if eq .Method "POST"}}
	body := new(bytes.Buffer)
	json.NewEncoder(body).Encode({{bodyParameterName .}})
	req, err := http.NewRequest("{{.Method}}", path, body)
	//-{{else}}
	req, err := http.NewRequest("{{.Method}}", path, nil)
	//-{{end}}
	if err != nil {
		return
	}
	resp, err := http.DefaultClient.Do(req)
	if err != nil {
		return
	}
    response = &{{.ResultTypeName}}{}
	//-{{range .ResponsesType.Fields}}
	//-{{if eq .Name "Default"}}
	if resp.StatusCode == 200 {
    		defer resp.Body.Close()
    		body, err := ioutil.ReadAll(resp.Body)
            fmt.Printf("%v %s\n", err, string(body))
    		result := &{{.ValueType}}{}
            err = json.Unmarshal(body, result)
    		decoder := json.NewDecoder(resp.Body)
    		err = decoder.Decode(result)
    		response.{{.Name}} = result
    }
	//-{{end}}
	//-{{end}}
	return
}

//-{{end}}

// refer to imported packages that may or may not be used in generated code
func forced_package_references() {
	_ = new(bytes.Buffer)
	_ = fmt.Sprintf("")
	_ = strings.Split("","")
}